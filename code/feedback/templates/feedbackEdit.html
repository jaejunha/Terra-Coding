<html lang="en">
{% load staticfiles %}
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<link rel="shortcut icon" type="image/x-icon" href="{% static 'img/T-HUB.png' %}"/>
	<title>::Source Editor::</title>
	<style>
		textarea.autosize { min-height: 50px; }
		#submit{
			text-decoration: none;
			font-family: 'Open Sans', sans-serif;
			font-weight: normal;
			font-size: 1em;
			color:#000000;
			padding:5px 15px;
			background:#787878;
			border:0 none;
			cursor:pointer;
			margin-top: 5px;
		}
		.result_box{
	    margin: 10px;
	    padding: 10px;
	    height: auto;
	    overflow: hidden;
	  }
	</style>
	<script language="Javascript" type="text/javascript" src="{% static 'package/edit_area/edit_area_full.js' %}"></script>
	<script type="text/javascript" src="{% static 'js/jquery-3.2.1.js' %}"></script>
	<script type="text/javascript" src="{% static 'js/jquery-ui.js' %}"></script>
	<script language="Javascript" type="text/javascript">
		$(document).ready(function() {
			{% if code %}	
				$('#sourceEditorArea').val({{code}});
			{% else %}
				$('#sourceEditorArea').val('import java.util.Scanner;\n\npublic class test {\n\tpublic static void main(String args[]) {\n\t\tScanner scan = new Scanner(System.in);\n\n\t}\n}');
			{% endif %}
			editAreaLoader.init({
        	        id: "sourceEditorArea"  // id of the textarea to transform
               	 	,start_highlight: true  // if start with highlight
                	,allow_resize: "both"
                	,allow_toggle: true
                	,word_wrap: true
                	,language: "en"
                	,syntax: "java" 
                	,toolbar: "search, go_to_line, |, undo, redo, |, select_font, |, syntax_selection, |, change_smooth_selection, highlight, reset_highlight, |, help"
		        ,syntax_selection_allow: "java"
			});
		});

		
		function resize(obj) {
		  obj.style.height = "1px";
		  obj.style.height = (12+obj.scrollHeight)+"px";
		}

		// callback functions
		function my_save(id, content){
			alert("Here is the content of the EditArea '"+ id +"' as received by the save callback function:\n"+content);
		}

		function my_load(id){
			editAreaLoader.setValue(id, "The content is loaded from the load_callback function into EditArea");
		}

		function test_setSelectionRange(id){
			editAreaLoader.setSelectionRange(id, 100, 150);
		}

		function test_getSelectionRange(id){
			var sel =editAreaLoader.getSelectionRange(id);
			alert("start: "+sel["start"]+"\nend: "+sel["end"]);
		}

		function test_setSelectedText(id){
			text= "[REPLACED SELECTION]";
			editAreaLoader.setSelectedText(id, text);
		}

		function test_getSelectedText(id){
			alert(editAreaLoader.getSelectedText(id));
		}

		function toogle_editable(id)
		{
			editAreaLoader.execCommand(id, 'set_editable', !editAreaLoader.execCommand(id, 'is_editable'));
		}

		function editAreaLoaded(id){
			open_file1();
		}

		function open_file1()
		{
			var new_file= {id: "test", text: "{% autoescape off %}{% filter escapejs %}{{ code }}{% endfilter %}{% endautoescape %}", syntax: 'c'};
			editAreaLoader.openFile('sourceEditorArea', new_file);
		}

		function close_file1()
		{
			editAreaLoader.closeFile('sourceEditorArea', "test");
		}
	</script>
</head>
<!--_______________ END OF HEAD _______________-->

<body>
		<form action="/feedback/feedbackEdit" method="POST" style="display:inline;">
			{% csrf_token %}
				<textarea class="autosize" onkeydown="resize(this)" onkeyup="resize(this)" id="sourceEditorArea" style="height: 40%; width: 100%;" name="edit_data">{{code}}</textarea>
				<input type="hidden" name="operation" value="Write"/>
				<div align="right">
				{% if success %}
				{% else %}
				<input id="submit" type="submit" value="Submit" onclick="return confirm('Are you sure want to submit this code? :)')"/>
				{% endif %}
				</div>
		</form>
		<h3><b>Result</b></h3>
		<div class="result_box"><pre>{{result}}</pre>
		{% for e in etc %}
		{{e}}<br>
		{% endfor %}
		</div>
</body>
</html>
